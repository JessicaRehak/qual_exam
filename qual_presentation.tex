% NEUTRONICS BEAMER TEMPLATE -- START EDITING IN LINE 90

\documentclass[xcolor=x11names, compress]{beamer}
\usepackage{pgfpages}
\usefonttheme[onlymath]{serif}
\setbeamerfont{caption}{size=\scriptsize}
\setbeameroption{show notes on second screen=right}
\include{neutronics_template}
\setbeamertemplate{bibliography item}{\insertbiblabel}
% \setbeamertemplate{note page}{\pagecolor{yellow!5}\insertnote}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{appendixnumberbeamer}
\usepackage{booktabs}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage[super]{nth}
\usepackage{sty/commands}
\newcommand\Warning{%
 \makebox[1.4em][c]{%
 \makebox[0pt][c]{\raisebox{.1em}{\small!}}%
 \makebox[0pt][c]{\color{red}\Large$\bigtriangleup$}}}%
%THIS IS THE BEAR WATERMARK IN THE COVER SLIDE; YOU MAY EXCLUDE IT
%\SetWatermarkText{\includegraphics{0calbear.jpg}}
%\SetWatermarkAngle{0}
%\SetWatermarkScale{0.61}
%%%%%%%%%%%%%%%%%%%%%%

%THIS IS THE INFO AT THE BOTTOM OF YOUR FRAMES
\title{Qualification Exam}
\author{J.S. Rehak}
\date{September \nth{4}, 2019}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[plain]
%THIS IS THE TITLE OF THE TALK
\title{Title of Qualification Exam Talk}

%FEEL FREE TO EDIT THE COVER LAYOUT AS NEEDED
\author{
\begin{tabular}{c}
%YOUR NAME
J. S. Rehak\\
\vspace{10pt}\\
\includegraphics[height=2.5cm]{0bk.eps}
\end{tabular}}
\date{\vspace{-20pt}\\
  \begin{tabular}{c}
    \large{Qualification Exam} \\
 September \nth{4}, 2019
  \end{tabular}
}

\titlepage
\end{frame}

%----------------------------------------------------------%
% WHEN YOU START A NEW SECTION, IT WILL SHOW UP AS A CLICKABLE
% SHORTCUT AT THE TOP OF YOUR FRAMES

\begin{frame}
  \frametitle{Outline}
  \tableofcontents
\end{frame}

\section{Motivation}

\section{\scshape Background}

\frame[c]{\frametitle{Steady-state Boltzman Transport Equation}

  Our problem of interest is the time-independent transport equation
  for a critical system on a domain of interest
  $\rvec \in \mathbb{D}$,$E \in \mathbb{E}$~\cite{lewis1993}
  
\begin{align*} 
  &\left[\oh\cdot  \nabla + \Sigma_t(\rvec,E)\right]\psi(\rvec,E,\oh)\\
  & \quad = \int_0^{\infty}dE'\int_{4\pi}d\oh'\Sigma_s(\rvec, E'\rightarrow E,\oh'\rightarrow\oh)
    \psi(\rvec,E',\oh') \\ & \quad + Q(\rvec, E, \oh)
  % & \quad +  \chi(E)\int_0^{\infty}dE'\nu\Sigma_f(\rvec,
  %   E')\int_{4\pi}d\oh'\psi(\rvec, E', \oh')\;,
\end{align*}
with a given boundary condition,
\begin{align*}
  c_0\psi(\rvec, \oh, E) + c_1\frac{\partial\psi(\rvec, \oh,
  E)}{\partial \rvec}= f(\rvec, \oh, E), \quad 
  \hat{n} \cdot \oh < 0,
  \rvec \in \partial\mathbb{D}
\end{align*}
  
}

\frame[c]{\frametitle{Energy discretization}
  Introduce a discretization of the energy domain $\mathbb{E}$ into $G$
  non-overlapping elements, such that
  \begin{align*}
    E_h = \left\{E_1, E_2, \ldots, E_G\right\}, \quad \mathbb{E} = \bigcup_{g=1}^GE_g
  \end{align*}

  Assume that the energy-dependent angular flux can be separated into
  a group angular flux and a energy function within each of
  these groups
  \begin{align*}
    \psi(\rvec, E, \oh) \approx \psi_g(\rvec, \oh)f_g(E), \quad E \in E_g 
  \end{align*}
  Finally, assume that
  \begin{align*}
    \int_{E_{g'} \in E_h}f_g(E) dE = \delta_{g, g'}
  \end{align*}
}

\frame[c]{\frametitle{Self-adjoint angular flux equation (SAAF)}
  \pause
 Start with the single-group first-order transport equation~\cite{Morel1999}:
  \begin{equation}
    \label{eq:single_group_for_saaf}
    \oh \cdot \nabla \psi + \Sigma_t \psi = S \psi + q\;.
  \end{equation}
  \pause
Solve for $\psi$,
  \begin{equation*}
    \psi = \frac{1}{\Sigma_t}\left[S\psi + q - \oh \cdot \nabla \psi\right]\;,
  \end{equation*}
  and plug back into the gradient term in
  Eq.\ref{eq:single_group_for_saaf}.
    \pause
  \begin{block}{}
    \begin{equation*}
    - \oh \cdot \nabla \frac{1}{\Sigma_t}\oh \cdot \nabla \psi +
      \Sigma_t \psi = S\psi + q - \oh \cdot \nabla \frac{S\psi +
        q}{4\pi}
    \end{equation*}
  \end{block}
  With boundary conditions, for all $\vec{r} \in \partial D$:
  \begin{equation*}
      \psi = f, \quad \oh
      \cdot \hat{n} < 0 
    \end{equation*}
\begin{equation*}
      \oh \cdot \nabla \psi + \Sigma_t\psi= S\psi + q, \quad \oh
      \cdot \hat{n} > 0 
    \end{equation*}
\note{The Self-adjoint angular flux equation (SAAF) is a second-order from
  of the transport equation introduced by Morel and McGhee in 1999. To
  derive, consider scattering term part of tte source. Properties of SAAF
  \begin{itemize}
  \item +Can solve using standard CFEM methods, which give SPD matrices
    (can use CG instead of GMRES)  
  \item +Full angular flux is obtained by solve (unlike Even/Odd
    parity)
  \item +BCs only coupled in one direction when reflective
  \item -General sparse matrix, not block lower-triangular (no
    sweeping)
  \item -Pure scattering causes issues like odd-parity
  \end{itemize}

}
}

\section{Acceleration Methods}

\frame[c]{\frametitle{Nonlinear Diffusion Acceleration (NDA)}
\pause
  Start, again, with the single-group first-order transport
  equation~\cite{Hammer2017}, integrated over angle:
  \begin{equation*}
    \nabla \cdot J_g + \left(\Sigma_{t,g} - \Sigma_s^{g\to g}\right)
    \phi_g = \sum_{g' \neq g}\Sigma_s^{g' \to g}\phi_{g'} + q_g,\quad J_g \equiv \int
    d\oh \oh \psi_g\;.
  \end{equation*}
  \pause
  As a closure to this problem, it is common to define current using \textit{Fick's law},
  \begin{equation*}
    J_g = -D\nabla \phi_g\;.
  \end{equation*}
  \pause
  Construct an additive correction to the current using information
  from an angular solve:
  \begin{align*}
    J_g &= -D\nabla \phi_g + J_g^{\text{ang}} - J_g^{\text{ang}}\\
        &= -D\nabla \phi_g + \int_{4\pi}d\oh\oh\psi_g +
          D\nabla\phi_g
  \end{align*}
  
  \note{
    \begin{itemize}
    \item Uses a lower order diffusion solve to accelerate a higher
    order solve. 
  \item Start with the same single-group first-order
    transport equation, multiply by and integrate over angle, giving the
    ``neutron continuity equation.''
  \item We need closure for this problem, so often we use Fick's law,
    we will introduce a correction onto Fick's Law based on a higher
    order solve.
  \item We will introduce an additive correction based on our two
    definitions of the current.
    \end{itemize}
}
}

\frame[c]{\frametitle{Nonlinear Diffusion Acceleration (NDA)}
  Fold the additive correction into a \textit{drift-diffusion vector}:
  \begin{align*}
    J_g &= -D\nabla \phi_g + \int_{4\pi}d\oh\oh\psi_g +
          D\nabla\phi_g \\
        &= -D\nabla\phi_g + \left[\frac{\int_{4\pi}d\oh\oh\psi_g +
          D\nabla\phi_g}{\phi_g}\right]\phi_g \\
        &= -D \nabla \phi_g + \hat{D}_g\phi_g\;.
  \end{align*}
  \pause
  Plugging this into our integrated transport equation gives the
low-order non-linear diffusion acceleration equation (LONDA),
  \begin{block}{}
    \begin{equation*}
      \nabla\cdot\left[-D\nabla + \hat{D}_g\right]\phi_g +
      \left(\Sigma_{t,g} - \Sigma_s^{g \to g}\right)\phi_g = \sum_{g' \neq g}\Sigma_s^{g' \to g}\phi_{g'} + q_g
    \end{equation*}
  \end{block}

  
  \note{
    \begin{itemize}
    \item We combine these corrections into a drift diffusion vector.
    \item This gives us the LONDA equation, which is just the same
      integrated transport equation with a corrected current term.
    \item Presumably, the ``higher order'' angular solve will have
      better current information, so we can use it to calculate the drift diffusion vector.
    \end{itemize}
  }
}

\frame[c]{\frametitle{NDA algorithm}
  \begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/nda_flowchart}
    \caption{NDA Algorithm.\label{fig:nda_algorithm}}
  \end{figure}

  \note{
    \begin{itemize}
    \item NDA algorithm showing inner low order loop, and outer high
      order loop.
    \item In general, outer loop updates both scattering and fission
      source, checking for $k$ convergence. Inner loop updates
      fission source, also checking $k$ convergence.
    \end{itemize}
  }
}

\frame[c]{\frametitle{Single-group steady-state transport equation}
  \begin{align*}
  &\left[\oh\cdot  \nabla + \Sigma_t(\rvec,E)\right]\psi_g(\rvec,\oh)\\
  & \quad = \sum_{g' = 1}^G\int_{4\pi}d\oh'\Sigma_s(\rvec, E_{g'}\rightarrow E_g,\oh'\rightarrow\oh)
    \psi_{g'}(\rvec,\oh') +  Q_g(\rvec, \oh)
  \end{align*}
  
}

\frame[c]{\frametitle{Transport equation second-order forms}
  Consider the mono-energetic form of the transport equation, using the scattering operator $S\psi(\rvec, \oh) = \int_{4\pi}d\oh'\Sigma_s(\rvec,
  \oh'\rightarrow\oh)\psi(\rvec,\oh')$:
  \begin{equation}
    \label{eq:monoenergetic}
    \left[\oh\cdot \nabla + \Sigma_t(\rvec)\right]\psi(\rvec, \oh) = 
    S\psi(\rvec, \oh) + Q
  \end{equation}
Substitute $-\oh$ for $\oh$, add to
Eq.~\eqref{eq:monoenergetic}, and divide by two to get a function of even-
and odd-parity angular fluxes.

\begin{align*}
  \oh\cdot\nabla\psi^- + \Sigma_t\psi^+ = S^+\psi^+ + Q^+
\end{align*}
where,
\begin{align*}
  \psi^+ = \frac{1}{2}\left(\psi(\oh) + \psi(-\oh)\right) \\
  \psi^- = \frac{1}{2}\left(\psi(\oh) - \psi(-\oh)\right) \\
\end{align*}

}

\begin{frame}
  \frametitle{Acknowledgments}
  \begin{figure}[h!]
    \centering
    \includegraphics[scale=0.4]{images/nrc}
  \end{figure}\centering
  \small This work was prepared by Joshua Rehak under award number
  NRC-HQ-84-14-G-0042 from the Nuclear Regulatory Commission. The
  statements, findings, conclusions, and recommendations are those of
  the authors and do not necessarily reflect the view of the US
  Nuclear Regulatory Commission.
\end{frame}

\appendix

\frame{\frametitle{References}
\tiny{\bibliographystyle{plain}}
\bibliography{bib/bib}
}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
